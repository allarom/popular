{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/ar/projects/popular/components/ForceLayout.jsx\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState, useRef } from 'react';\nimport dynamic from 'next/dynamic';\nimport { select, hierarchy, tree, linkVertical, forceSimulation, forceCenter, mouse, forceX, forceY, forceCollide, forceRadial } from \"d3\";\nimport json from './lang';\nimport { forceManyBody } from 'd3-force';\n\nvar useResizeObserver = function useResizeObserver(ref) {\n  var _useState = useState(null),\n      dimensions = _useState[0],\n      setDimensions = _useState[1];\n\n  useEffect(function () {\n    var observeTarget = ref.current;\n    var resizeObserever = new useResizeObserver(function (entries) {\n      console.log(entries);\n    });\n    resizeObserver.observe(observeTarget);\n    return function () {\n      resizeObserever.unobserve(observeTarget);\n    };\n  }, [ref]);\n  return dimensions;\n};\n\nvar Page = function Page(props) {\n  var svgRef = useRef();\n  var dimensions = useResizeObserver(wrapperRef);\n  useEffect(function () {\n    var svg = select(svgRef.current);\n    var root = hierarchy(json);\n    var nodeData = root.descendants();\n    var linkData = root.links();\n    var simulation = forceSimulation(nodeData) // force\n    .force(\"center\", forceCenter(1000, 1000)).force(\"charge\", forceManyBody().strength(-40)).force(\"collide\", forceCollide(60)).on(\"tick\", function () {\n      console.log(\"current force\", simulation.alpha());\n      var linkGenerator = linkVertical().x(function (node) {\n        return node.x;\n      }).y(function (node) {\n        return node.y + 100;\n      });\n      svg.selectAll(\".node\").data(nodeData).join(\"circle\").attr(\"class\", \"node\").attr(\"r\", 5).attr(\"fill\", \"grey\").attr(\"cx\", function (node) {\n        return node.x;\n      }).attr(\"cy\", function (node) {\n        return node.y + 100;\n      }); // svg\n      // .selectAll(\".link\")\n      // .data(linkData)\n      // .join(\"path\").attr(\"class\",\"link\")\n      // .attr(\"fill\", \"none\")\n      // .attr(\"stroke\", \"grey\")\n      // .attr(\"d\", linkGenerator)\n      // .attr(\"x1\", link => link.source.x)\n      // .attr(\"y1\", link => link.source.y)\n      // .attr(\"x2\", link => link.target.x)\n      // .attr(\"y2\", link => link.target.y)\n\n      svg.selectAll(\".label\").data(root.descendants()).join(\"text\").attr(\"class\", \"label\").attr(\"fill\", \"black\").text(function (node) {\n        return node.data.language;\n      }).attr(\"font-size\", 16).attr(\"text-anchor\", \"middle\").attr(\"x\", function (node) {\n        return node.x;\n      }).attr(\"y\", function (node) {\n        return node.y + 85;\n      });\n    });\n    svg.on(\"mousemove\", function () {\n      var _mouse = mouse(svgRef.current),\n          _mouse2 = _slicedToArray(_mouse, 2),\n          x = _mouse2[0],\n          y = _mouse2[1];\n\n      simulation.force(\"x\", forceX(x).strength(function (node) {\n        return 0.2 + node.depth * 0.15;\n      })).force(\"y\", forceY(y).strength(function (node) {\n        return 0.2 + node.depth * 0.15;\n      }));\n    });\n    svg.on(\"click\", function () {\n      var _mouse3 = mouse(svgRef.current),\n          _mouse4 = _slicedToArray(_mouse3, 2),\n          x = _mouse4[0],\n          y = _mouse4[1];\n\n      simulation.alpha(0.5).restart().force(\"orbit\", forceRadial(100, x, y));\n      svg.selectAll(\".orbit\").data([json]).join(\"circle\").attr(\"class\", \"orbit\").attr(\"fill\", \"none\").attr(\"r\", 500).attr(\"cx\", x).attr(\"cy\", y);\n    });\n  }, [json]);\n  return __jsx(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    ref: wrapperRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, __jsx(\"svg\", {\n    ref: svgRef,\n    width: \"2000px\",\n    height: \"2000px\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  })), __jsx(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }), __jsx(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, \"Forced Layout\"));\n};\n\nexport default Page;","map":{"version":3,"sources":["/Users/ar/projects/popular/components/ForceLayout.jsx"],"names":["React","useEffect","useState","useRef","dynamic","select","hierarchy","tree","linkVertical","forceSimulation","forceCenter","mouse","forceX","forceY","forceCollide","forceRadial","json","forceManyBody","useResizeObserver","ref","dimensions","setDimensions","observeTarget","current","resizeObserever","entries","console","log","resizeObserver","observe","unobserve","Page","props","svgRef","wrapperRef","svg","root","nodeData","descendants","linkData","links","simulation","force","strength","on","alpha","linkGenerator","x","node","y","selectAll","data","join","attr","text","language","depth","restart"],"mappings":"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","sourcesContent":["import React, {useEffect, useState, useRef} from 'react'\nimport dynamic from 'next/dynamic'\nimport { select, hierarchy, tree, linkVertical, forceSimulation, forceCenter, mouse,  forceX,  forceY, forceCollide, forceRadial} from \"d3\"\nimport json from './lang'\nimport { forceManyBody } from 'd3-force';\n\nconst useResizeObserver = (ref) => {\n  const [dimensions, setDimensions] = useState(null)\n\n  useEffect(() => {\n  const observeTarget = ref.current\n  const resizeObserever = new useResizeObserver((entries) => {\n    console.log(entries)\n  })\n  resizeObserver.observe(observeTarget)\n  return () => {\n    resizeObserever.unobserve(observeTarget)\n  }\n  }, [ref])\n  return dimensions;\n\n}\n\nconst Page = (props) => {\n  const svgRef = useRef()\n  const dimensions = useResizeObserver(wrapperRef)\n\tuseEffect(() => {\n\t\tconst svg = select(svgRef.current)\n\t\tconst root = hierarchy(json)\n    const nodeData = root.descendants()\n    const linkData = root.links()\n    \n    const simulation = forceSimulation(nodeData)\n    // force\n    .force(\"center\", forceCenter(1000, 1000))\n    .force(\"charge\", forceManyBody().strength(-40))\n    .force(\"collide\", forceCollide(60))\n    .on(\"tick\", () => {\n      console.log(\"current force\", simulation.alpha())\n      const linkGenerator = linkVertical()\n      .x(node => node.x)\n      .y(node => node.y + 100)\n  \n      svg\n      .selectAll(\".node\")\n      .data(nodeData)\n      .join(\"circle\")\n      .attr(\"class\", \"node\")\n      .attr(\"r\", 5)\n      .attr(\"fill\", \"grey\")\n      .attr(\"cx\", node => node.x)\n      .attr(\"cy\", node => node.y + 100)\n  \n      // svg\n      // .selectAll(\".link\")\n      // .data(linkData)\n      // .join(\"path\").attr(\"class\",\"link\")\n      // .attr(\"fill\", \"none\")\n      // .attr(\"stroke\", \"grey\")\n      // .attr(\"d\", linkGenerator)\n      // .attr(\"x1\", link => link.source.x)\n      // .attr(\"y1\", link => link.source.y)\n      // .attr(\"x2\", link => link.target.x)\n      // .attr(\"y2\", link => link.target.y)\n  \n      svg\n      .selectAll(\".label\")\n      .data(root.descendants())\n      .join(\"text\")\n      .attr(\"class\", \"label\")\n      .attr(\"fill\", \"black\")\n      .text(node => node.data.language)\n      .attr(\"font-size\", 16)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", node => node.x)\n      .attr(\"y\", node => node.y + 85)\n  \n    })\n\n    svg.on(\"mousemove\", ()=> {\n      const [x,y] = mouse(svgRef.current)\n      simulation\n      .force(\"x\", forceX(x).strength(node => 0.2 + node.depth * 0.15))\n      .force(\"y\", forceY(y).strength(node => 0.2 + node.depth * 0.15))\n    })\n\n    svg.on(\"click\", () => {\n       const [x, y] = mouse(svgRef.current)\n       simulation\n       .alpha(0.5)\n       .restart()\n       .force(\"orbit\", forceRadial(100, x, y))\n\n       svg.selectAll(\".orbit\")\n       .data([json])\n       .join(\"circle\")\n       .attr(\"class\", \"orbit\")\n       .attr(\"fill\", \"none\")\n       .attr(\"r\", 500)\n       .attr(\"cx\", x)\n       .attr(\"cy\", y)\n    })\n\t}, [json])\n\nreturn (\n\t<React.Fragment>\n    <div ref={wrapperRef}>\n      \t<svg ref={svgRef}  width='2000px' height='2000px'></svg>\n    </div>\n\t\t<br/>\n    <h1>Forced Layout</h1>\n\t</React.Fragment>\n )\n\n}\n\nexport default Page\n"]},"metadata":{},"sourceType":"module"}