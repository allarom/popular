{"ast":null,"code":"var _jsxFileName = \"/Users/ar/projects/popular/components/ForceLayout.jsx\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState, useRef } from 'react';\nimport dynamic from 'next/dynamic';\nimport { select, hierarchy, tree, linkVertical, forceSimulation, forceCenter, mouse, forceX, forceY, forceCollide, forceRadial } from \"d3\";\nimport json from './lang';\nimport { forceManyBody } from 'd3-force';\nimport useResizeObserver from '../hooks/useResizeObeserver';\n\nconst Page = props => {\n  const svgRef = useRef();\n  const wrapperRef = useRef();\n  const dimensions = useResizeObserver(wrapperRef);\n  useEffect(() => {\n    console.log(dimensions);\n    if (!dimensions) return;\n    const svg = select(svgRef.current);\n    const root = hierarchy(json);\n    const nodeData = root.descendants();\n    const linkData = root.links();\n    const simulation = force(nodeData) // force\n    .force(\"center\", forceCenter(dimensions.width / 2, dimensions.height / 2)).force(\"charge\", forceManyBody().strength(-40)).force(\"collide\", forceCollide(60)).on(\"tick\", () => {\n      const linkGenerator = linkVertical().x(node => node.x).y(node => node.y + 100);\n      svg.selectAll(\".node\").data(nodeData).join(\"circle\").attr(\"class\", \"node\").attr(\"r\", 5).attr(\"fill\", \"grey\").attr(\"cx\", node => node.x).attr(\"cy\", node => node.y + 100);\n      svg.selectAll(\".link\").data(linkData).join(\"path\").attr(\"class\", \"link\").attr(\"fill\", \"none\").attr(\"stroke\", \"grey\").attr(\"d\", linkGenerator).attr(\"x1\", link => link.source.x).attr(\"y1\", link => link.source.y).attr(\"x2\", link => link.target.x).attr(\"y2\", link => link.target.y);\n      svg.selectAll(\".label\").data(root.descendants()).join(\"text\").attr(\"class\", \"label\").attr(\"fill\", \"black\").text(node => node.data.language).attr(\"font-size\", 16).attr(\"text-anchor\", \"middle\").attr(\"x\", node => node.x).attr(\"y\", node => node.y + 85);\n    });\n    svg.on(\"mousemove\", () => {\n      const [x, y] = mouse(svgRef.current);\n      simulation.force(\"x\", forceX(x).strength(node => 0.2 + node.depth * 0.15)).force(\"y\", forceY(y).strength(node => 0.2 + node.depth * 0.15));\n    });\n    svg.on(\"click\", () => {\n      const [x, y] = mouse(svgRef.current);\n      simulation.alpha(0.5).restart().force(\"orbit\", forceRadial(100, x, y));\n      svg.selectAll(\".orbit\").data([json]).join(\"circle\").attr(\"class\", \"orbit\").attr(\"fill\", \"none\").attr(\"r\", 500).attr(\"cx\", x).attr(\"cy\", y);\n    });\n  }, [json, dimensions]);\n  return __jsx(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    ref: wrapperRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, __jsx(\"svg\", {\n    ref: svgRef,\n    height: \"100vh\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  })), __jsx(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }), __jsx(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, \"Forced Layout\"));\n};\n\nexport default Page;","map":{"version":3,"sources":["/Users/ar/projects/popular/components/ForceLayout.jsx"],"names":["React","useEffect","useState","useRef","dynamic","select","hierarchy","tree","linkVertical","forceSimulation","forceCenter","mouse","forceX","forceY","forceCollide","forceRadial","json","forceManyBody","useResizeObserver","Page","props","svgRef","wrapperRef","dimensions","console","log","svg","current","root","nodeData","descendants","linkData","links","simulation","force","width","height","strength","on","linkGenerator","x","node","y","selectAll","data","join","attr","link","source","target","text","language","depth","alpha","restart"],"mappings":"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","sourcesContent":["import React, {useEffect, useState, useRef} from 'react'\nimport dynamic from 'next/dynamic'\nimport { select, hierarchy, tree, linkVertical, forceSimulation, forceCenter,  mouse,  forceX,  forceY, forceCollide, forceRadial} from \"d3\"\nimport json from './lang'\nimport { forceManyBody } from 'd3-force';\nimport useResizeObserver from '../hooks/useResizeObeserver'\n\n\nconst Page = (props) => {\n  const svgRef = useRef()\n  const wrapperRef = useRef()\n  const dimensions = useResizeObserver(wrapperRef)\n\tuseEffect(() => {\n    console.log(dimensions)\n    if(!dimensions) return\n\t\tconst svg = select(svgRef.current)\n\t\tconst root = hierarchy(json)\n    const nodeData = root.descendants()\n    const linkData = root.links()\n    \n    const simulation = force(nodeData)\n    // force\n    .force(\"center\", forceCenter(dimensions.width/2, dimensions.height/2))\n    .force(\"charge\", forceManyBody().strength(-40))\n    .force(\"collide\", forceCollide(60))\n    .on(\"tick\", () => {\n      const linkGenerator = linkVertical()\n      .x(node => node.x)\n      .y(node => node.y + 100)\n  \n      svg\n      .selectAll(\".node\")\n      .data(nodeData)\n      .join(\"circle\")\n      .attr(\"class\", \"node\")\n      .attr(\"r\", 5)\n      .attr(\"fill\", \"grey\")\n      .attr(\"cx\", node => node.x)\n      .attr(\"cy\", node => node.y + 100)\n  \n      svg\n      .selectAll(\".link\")\n      .data(linkData)\n      .join(\"path\").attr(\"class\",\"link\")\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", \"grey\")\n      .attr(\"d\", linkGenerator)\n      .attr(\"x1\", link => link.source.x)\n      .attr(\"y1\", link => link.source.y)\n      .attr(\"x2\", link => link.target.x)\n      .attr(\"y2\", link => link.target.y)\n  \n      svg\n      .selectAll(\".label\")\n      .data(root.descendants())\n      .join(\"text\")\n      .attr(\"class\", \"label\")\n      .attr(\"fill\", \"black\")\n      .text(node => node.data.language)\n      .attr(\"font-size\", 16)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", node => node.x)\n      .attr(\"y\", node => node.y + 85)\n  \n    })\n\n    svg.on(\"mousemove\", ()=> {\n      const [x,y] = mouse(svgRef.current)\n      simulation\n      .force(\"x\", forceX(x).strength(node => 0.2 + node.depth * 0.15))\n      .force(\"y\", forceY(y).strength(node => 0.2 + node.depth * 0.15))\n    })\n\n    svg.on(\"click\", () => {\n       const [x, y] = mouse(svgRef.current)\n       simulation\n       .alpha(0.5)\n       .restart()\n       .force(\"orbit\", forceRadial(100, x, y))\n\n       svg.selectAll(\".orbit\")\n       .data([json])\n       .join(\"circle\")\n       .attr(\"class\", \"orbit\")\n       .attr(\"fill\", \"none\")\n       .attr(\"r\", 500)\n       .attr(\"cx\", x)\n       .attr(\"cy\", y)\n    })\n\t}, [json, dimensions])\n\nreturn (\n\t<React.Fragment>\n    <div ref={wrapperRef}>\n      \t<svg ref={svgRef} height=\"100vh\"></svg>\n    </div>\n\t\t<br/>\n    <h1>Forced Layout</h1>\n\t</React.Fragment>\n )\n\n}\n\nexport default Page\n"]},"metadata":{},"sourceType":"module"}